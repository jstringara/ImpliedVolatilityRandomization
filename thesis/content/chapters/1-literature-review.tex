\section{Literature Review and Analysis}

\subsection{Problem Setting}

In financial markets, the pricing of vanilla European options, either calls or puts, is a fundamental task that hinges on the accurate estimation of the underlying asset's volatility.
In practice, markets do not quote option prices directly, but rather the \textbf{Black-Scholes implied volatility}, denoted by $\hat{\sigma}(T, K)$, which depends on the option's time to maturity $T$ and strike price $K$.
Given a particular combination of $(T, K)$, the market provides a value $\hat{\sigma}(T, K)$ such that the corresponding option price can be computed using the Black-Scholes formula:
\begin{equation}
    V_c(T,K) = BS(t_0, S_0, T, K; \hat{\sigma}(T,K)),
\end{equation}

where $BS(t_0, S_0, T, K; \hat{\sigma}(T,K))$ denotes the Black-Scholes price of a European call option with strike $K$ and maturity $T$, evaluated at time $t_0$, given a spot price $S_0$, a constant risk-free rate $r$, and implied volatility $\hat{\sigma}(T, K)$.

As is well known, the Black-Scholes model assumes that the underlying asset follows a geometric Brownian motion with constant volatility, a convenient but overly simplistic assumption that fails to reflect many features observed in real markets. Nevertheless, implied volatility serves as a standard market quoting convention, and practitioners work within this framework to price and hedge derivatives.

Typically, market data consists of implied volatility quotes for a finite grid of strikes and maturities. We denote this discrete dataset as:

\begin{equation}
    \Theta_{\text{mkt}} = \left\{ \hat{\sigma}_{\text{mkt}}(T_n, K_m) : 1 \leq n \leq N,\ 1 \leq m \leq M \right\}.
\end{equation}

In liquid markets, this set may be fairly dense, but in many cases, especially for less liquid underlyings, only a sparse set of quotes may be observed, with limited coverage in both strike and maturity.
This sparsity presents a major obstacle; in most real-world applications, one needs to produce implied volatility values for strike-maturity pairs that may not be directly quoted by the market.
For example, a market maker may need to quote an option with a non-standard expiry, or a trader may need to evaluate the price of a structured product referencing off-grid options.
The task, then, is to construct a \textbf{clean implied volatility surface} $\hat{\sigma}(T, K)$ from the discrete and potentially noisy market data $\Theta_{\text{mkt}}$.
More precisely, we seek a function
\[
    \hat{\sigma}(T, K): \Pi \to \mathbb{R}_+,
\]
defined over a suitable domain $\Pi \subset (t_0, \infty) \times \mathbb{R}_+$, such that the resulting surface provides meaningful volatility values for any desired combination of time to maturity and strike price.

This problem is far from trivial, as the resulting surface $\hat{\sigma}(T, K)$ must satisfy two essential properties:

\begin{itemize}
    \item \textbf{Consistency with market data}: the surface must match the observed market quotes at the points where they are available.
          That is, for any $(T_n, K_m) \in \Theta_{\text{mkt}}$, we must find that $\hat{\sigma}(T_n, K_m) = \hat{\sigma}_{\text{mkt}}(T_n, K_m)$.
    \item \textbf{Absence of static arbitrage}: the surface must not allow for arbitrage opportunities when plugged into the Black-Scholes formula.
          This means that the resulting option prices must respect key no-arbitrage conditions, such as monotonicity and convexity in strike, and the call-put calendar spread inequalities in maturity.
\end{itemize}

If such a surface can be constructed, one that is both consistent with the market and arbitrage-free, it becomes a powerful tool.
It allows for pricing of exotic derivatives, reconstruction of the risk-neutral distribution of the underlying asset, model calibration, and the generation of synthetic quotes.
Ultimately, it enables market participants to respond to pricing and risk management tasks with greater confidence and consistency, even in the absence of direct market observations.

\subsection{Existing Literature}

Implied volatility surface modeling has been extensively studied using stochastic and local volatility models, statistical analyses, arbitrage-aware interpolation schemes, and, more recently, machine learning techniques.
A comprehensive review is provided by Homescu~\cite{homescu2011implied}.
Here, we summarize and review the approaches most relevant to our methodology.

\subsubsection{Interpolation and Extrapolation Schemes}

A common and straightforward method to construct an implied volatility surface is to interpolate and extrapolate the available market quotes, yielding a surface $\hat\sigma: (T,K) \mapsto \mathbb{R}_+$.
However, interpolating directly in the implied volatilities space is known to produce surfaces that may violate arbitrage constraints, particularly the convexity of option prices with respect to the strike~\cite{andreasen2011volatility}.
This issue becomes particularly problematic when the dataset is sparse, as the interpolation then determines much of the surface beyond the observed points, leading to financially implausible shapes.

To address this, several methods construct arbitrage-free surfaces by interpolating on option prices instead of implied volatilities~\cite{lefloch2021arbitrage, corbetta2019robust}.
These approaches ensure consistency with no-arbitrage principles, but they require a numerical inversion, via root finding algorithms, of the Black-Scholes formula to recover implied volatilities, since the mapping from price to volatility is implicit.
Interpolation schemes are attractive because they exactly match the observed market quotes $\Theta_{\text{mkt}}$ by construction.
However, they often suffer from poor extrapolation behavior, especially when quotes are irregularly distributed or sparse~\cite{guo2016generalized}.
Furthermore, interpolated surfaces may lack the smoothness and robustness required for risk management or model calibration.

\subsubsection{Parametric Volatility Surfaces}

An alternative to interpolation is to define a family of parametric implied volatility surfaces indexed by a low-dimensional vector of parameters $\mathbf{p} \in \mathbb{R}^m$.
This defines a family of smooth, arbitrage-free surfaces specified by a function:
\[
    \hat{\sigma}(T, K; \mathbf{p}): \Pi \to \mathbb{R}_+,
\]
where the surface is fit to market quotes by solving a calibration problem:
\[
    \mathbf{p}^* = \arg\min_{\mathbf{p}} \sum_{(T_n, K_m) \in \Theta_{\text{mkt}}} \| \hat{\sigma}(T_n, K_m; \mathbf{p}) - \hat{\sigma}_{\text{mkt}}(T_n, K_m) \|,
\]
for a suitable choice of norm $\|\cdot\|$.
The ability to fit the market, therefore, directly depends on the “size” of the set of functions defined by $\{\hat{\sigma}(T, K; \mathbf{p})\}_{\mathbf{p} \in D}$, where $D \subseteq \mathbb{R}^m$ is the parameter space.
Popular examples of such models include the Stochastic Volatility Inspired (SVI) parametrization introduced by Gatheral~\cite{gatheral2011volatility} and further refined into an arbitrage-free version with Jacquier~\cite{gatheral2014arbitrage}, as well as the SABR model of Hagan et al.~\cite{hagan2002managing}.
These models are widely adopted due to their analytical tractability, ease of calibration, and robustness in sparse data regimes.

A key advantage of parametric surfaces is their ability to enforce absence of arbitrage through structural constraints on the parameter space $\mathbf{p} \in D \subseteq \mathbb{R}^m$.
In many cases, the models are derived from an underlying stochastic process for the asset, ensuring that arbitrage-free conditions are satisfied for any admissible parameter choice.
For instance, both SVI and SABR offer closed-form or semi-analytical expressions for implied volatility, and their parameters directly reflect key features of the smile and term structure.

This makes parametric models particularly appealing: they offer interpretability (e.g., linking parameters to skew or curvature), do not require a large number of quotes to produce a valid surface, and inherently preserve arbitrage-free properties.

However, the main limitation of classical parametrizations is their lack of flexibility.
When the true market-implied surface falls outside the functional class defined by the model, even the best-fitting parameter vector $\mathbf{p}^*$ may result in a poor approximation.
This is particularly relevant for short-dated equity options near corporate events, such as earnings announcements, where implied volatility smiles may become ``W-shaped'' or ``mustache-shaped'', indicating bimodal risk-neutral densities.
Such phenomena are well-documented by Glasserman and Pirjol~\cite{glasserman2023w} and Alexiou et al.~\cite{alexiou2023pricing}, and cannot be captured by standard diffusion-based models.

\subsubsection{Randomized Parametrizations}

To overcome the expressive limitations of classical models, recent work has introduced \textbf{randomized parametrizations}.
Zaugg, Perotti, and Grzelak~\cite{zaugg2024volatility} propose a framework in which one or more deterministic parameters in a standard model, such as SABR, are replaced by random variables.
The resulting implied volatility surface is then obtained by integrating over the distribution of these parameters, yielding enhanced flexibility while preserving analytical structure and arbitrage-freeness.

This randomized approach effectively enlarges the space of volatility surfaces without increasing the dimensionality of the calibration problem.
By specifying the distributional form of the random parameter(s) using a small set of additional hyperparameters, the authors retain tractability and control over the shape of the surface.
In particular, they demonstrate strong calibration performance for short-dated SPX optIions (with maturities below six months), a region where traditional parametrizations often struggle.
In practice we are effectively replacing a single deterministic volatility surface with a mixture of surfaces, each corresponding to a different realization of the random parameter(s).

Moreover, Zaugg et al.\ also consider \textbf{spot price randomization}, a novel mechanism that models uncertainty in the initial asset value.
This is especially relevant for near-expiry options subject to potential regime changes, such as equities approaching earnings announcements.
In such scenarios, the implied volatility surface can display multi-modality that reflects the market's anticipation of discrete jumps in price.
Spot randomization captures this behavior effectively, while ensuring the resulting surface remains arbitrage-free.

These innovations offer a general and modular methodology to enrich existing volatility surface models.
The approach is empirically validated through calibration examples on S\&P 500 and AMZN options, where the randomized models deliver better fits than their classical counterparts, especially in challenging market regimes.

%% TODO work on this next section explaining the methodology of Zaugg et al. in more detail, including the randomization framework, discretization, and applications to short-dated options.
\subsection{Parametric Volatility Surfaces and Their Limitations}

Let $\hat{\sigma}(T, K; \mathbf{p})$ denote a classical implied volatility surface parametrized by a vector $\mathbf{p} \in \mathbb{R}^m$, defined over a domain $\Pi \subseteq (t_0, \infty) \times \mathbb{R}_+$.
Classical models such as SVI and SABR define such surfaces based on analytically tractable stochastic processes.
These parametrizations are valued for their:

\begin{itemize}
    \item \textit{Arbitrage-free constraints}: ensured through structural properties of the surface or well-behaved parameter spaces;
    \item \textit{Calibration efficiency}: due to closed-form or semi-closed-form pricing equations;
    \item \textit{Interpretability}: model parameters have intuitive effects on smile, skew, and term structure;
    \item \textit{Robustness}: ability to generate surfaces from limited market data without requiring minimum quote thresholds.
\end{itemize}

However, a major drawback arises when the true market surface lies outside the span of $\{\hat{\sigma}(T,K; \mathbf{p})\}_{\mathbf{p} \in D}$, resulting in model misspecification and poor market fit.
This limitation manifests in two critical scenarios:

\textbf{Systematic Limitations}: Certain market behaviors are fundamentally incompatible with classical parametrizations. For instance, short-maturity options in equity markets exhibit steeper at-the-money implied volatility term structures than those attainable under regular stochastic volatility models. This reflects the inability of single-factor diffusion models to capture the complex dynamics of near-expiry options.

\textbf{Event-Driven Irregularities}: Markets can exhibit irregular behaviors during periods of heightened uncertainty. Very short-term options markets near earnings announcements commonly display W-shaped volatility curves or "mustache" shapes. These patterns arise from bimodal risk-neutral probability density functions reflecting the dichotomous nature of earnings outcomes. Classical diffusion models cannot replicate such multi-modal distributions due to their reliance on continuous diffusive drivers.

\subsection{Challenges in Short-Term Options Modeling}

The modeling of short-maturity options presents particular challenges that expose the limitations of traditional parametric approaches. Near-expiry options are characterized by:

\begin{itemize}
    \item \textit{Heightened sensitivity to discrete events}: Earnings announcements, regulatory decisions, or other binary outcomes can create bimodal risk-neutral densities.
    \item \textit{Extreme volatility shapes}: W-shaped implied volatility curves that cannot be captured by standard one-factor models.
    \item \textit{Rapid parameter changes}: Traditional calibration procedures may fail or yield extreme parameter values indicating model inconsistency.
    \item \textit{Market microstructure effects}: Bid-ask spreads and liquidity constraints can distort implied volatility patterns.
\end{itemize}

These challenges highlight the industry's need for more flexible parametrizations that can adapt to irregular market conditions while preserving computational efficiency and arbitrage-freeness.

\subsection{Randomization Framework}

The authors propose enhancing the flexibility of $\hat{\sigma}(T,K; \mathbf{p})$ by replacing one or more parameters $p_i$ with a random variable $\vartheta$. The resulting implied volatility surface is derived from the expectation of the corresponding pricing function:

\[
    \hat{\sigma}(T,K) \text{ such that } BS(t_0, S_0, T, K; \hat{\sigma}(T,K)) = \mathbb{E}_{\vartheta}[V_c(T,K; p(\vartheta))].
\]

This yields a mixture model of option prices that remains arbitrage-free under mild regularity assumptions on $\vartheta$ and $\hat{\sigma}$. The authors show that the implied pricing function preserves convexity and monotonicity (conditions for butterfly and calendar spread arbitrage, respectively) through integral arguments and convex combinations of valid surfaces.

The randomization framework draws inspiration from the RAnD (Risk and Drift) method while providing a more general and analytically tractable approach. By treating parameters as random variables rather than fixed constants, the method enables classical parametrizations to capture market behaviors previously outside their scope.

\subsection{Discretization and Parametric Extension}

To make this construction computationally feasible, the paper employs Gaussian quadrature to discretize the mixture:

\[
    V_c(T,K) \approx \sum_{n=1}^{N_q} \lambda_n V_c(T,K; p(\theta_n)).
\]

This transforms the randomized surface into an extended parametric form:
\[
    \hat{\sigma}(T,K; \mathbf{p}^*) = \text{BS}^{-1}\left(\sum_{n=1}^{N_q} \lambda_n V_c(T,K; p(\theta_n))\right),
\]
where $\mathbf{p}^*$ includes the original parameters (excluding $p_i$) and the distributional parameters of $\vartheta$ (e.g., $(\mu, \nu)$ for lognormal or $(k, \theta)$ for Gamma). The resulting model is therefore not only arbitrage-free but also retains parametric tractability with enhanced expressiveness.

\subsection{Analytic Expansion of Implied Volatility}

To avoid repeated root-finding, the authors derive a Taylor expansion of the randomized implied volatility function in terms of log-moneyness $m = \log(S_0/K) + rT$. Extending the approach of Brigo and Mercurio (2002), they express the implied volatility $\hat{\sigma}(T,K)$ as:

\[
    \hat{\sigma}(T,K) \approx P(0) + \frac{P^{(2)}(0)}{2!}m^2 + \frac{P^{(4)}(0)}{4!}m^4 + \frac{P^{(6)}(0)}{6!}m^6 + \mathcal{O}(m^8),
\]

where the coefficients $P^{(2i)}(0)$ are computed using the mixture weights and base volatilities. This expansion enables fast evaluation across large strike/time grids and is validated against root-finding solutions.

\subsection{Applications and Empirical Evidence}

\paragraph{1. Randomized Flat Volatility:}
A trivial constant-volatility model, when randomized with a lognormal variable, can produce volatility smiles similar to real market shapes. The resulting model is parsimonious (only two parameters), efficient, and retains analytical tractability.

\paragraph{2. Randomized SABR:}
By randomizing the volatility-of-volatility parameter $\gamma$ in the SABR model using a Gamma distribution, the authors significantly improve the model's ability to fit short-maturity SPX options. The randomized model outperforms standard SABR in terms of sum and mean squared errors, and captures skew curvature more accurately, particularly for options with expiry dates of less than six months.

\paragraph{3. Spot Price Randomization:}
To model W-shaped or bimodal implied volatilities (as observed before earnings announcements), the authors propose randomizing the spot price $S_0$. This produces a mixture of shifted probability density functions and enables modeling of multi-modal risk-neutral densities. The resulting surfaces are shown to be arbitrage-free as long as the random spot is centered at $S_0$. This approach proves particularly effective for modeling near-maturity options preceding earnings announcements, where traditional parametrizations fail completely.

\subsection{Position in Literature}

This framework complements and extends several strands of the literature:

\begin{itemize}
    \item \textit{Parametric Models}: Offers more flexibility than SABR or SVI while retaining analytical structure and computational efficiency.
    \item \textit{Mixture Models}: Provides a cleaner, parsimonious alternative to lognormal mixtures with fewer parameters and guaranteed arbitrage-freeness.
    \item \textit{Machine Learning}: Maintains interpretability and arbitrage-freeness, unlike black-box neural network approaches that often struggle with financial constraints.
    \item \textit{Market-Making Applications}: Enables practitioners to price options in extreme market conditions where traditional models fail, particularly important for liquidity providers in volatile markets.
\end{itemize}

The methodology addresses the fundamental trade-off between model flexibility and computational tractability that has long challenged practitioners. Unlike purely statistical or machine learning approaches, the randomization framework preserves the theoretical foundations of parametric models while extending their practical applicability.

\subsection{Conclusion}

The methodology introduced by Zaugg et al.\ strikes a balance between flexibility, computational efficiency, and financial interpretability. It enables classical models to adapt to irregular market conditions through controlled randomness, while preserving arbitrage constraints and maintaining calibration tractability.

The framework is particularly valuable for addressing the limitations of parametric models in extreme market conditions, such as pre-earnings volatility spikes and short-maturity option anomalies. By providing a generic enhancement method, it offers practitioners a systematic approach to improving existing parametrizations without abandoning their theoretical foundations.

From a research and practical standpoint, the framework opens further lines of inquiry:
\begin{itemize}
    \item Exploring multi-parameter or distributional combinations for enhanced flexibility.
    \item Developing adaptive calibration strategies for highly dynamic markets.
    \item Applying the method to exotic options or illiquid asset classes where traditional methods struggle.
    \item Investigating the framework's performance during extreme market events and crisis periods.
\end{itemize}

For the remainder of this thesis, we will build on this foundation to implement, analyze, and extend randomized volatility parametrizations using empirical and synthetic data, with particular focus on the challenging scenarios where traditional models reach their limits.
